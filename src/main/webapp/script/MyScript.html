<html lang="en">
<body>
<div class="my-script show-type">
    <div class="small-title"></div>
    <div class="info">
        <span>code：</span>
        <textarea id="runscriptCode" style="height: 200px;width:100%;background-color: #000;color:#e0ab37;" wrap="off"></textarea>
    </div>
    <div style="float: right">
        <span class="do-edit" data-id="">编辑脚本</span>
        <span class="do-delete" data-id="">删除脚本</span>
    </div>
</div>
<script>
    $(function(){
        $(this).delegate('.script-my-zi','click',function(){
            var id = $(this).attr("data-id");
            var suid = $(this).attr("data-suid");
            $.ajax({
                url:'/scriptedit/getScript',
                type:'post',
                data:{"id":id},
                dataType:'json',
                success:function(datas){
                    if(datas.code == 200){
                        $("#runscriptCode").val(datas.data.code);
                        $("#small-title").val("脚本名称："+datas.data.scriptName);
                        $("#test").show();
                        $("#log_window").show();
                        $(".my-script").show();
                    }else{
                        alert("服务器异常");
                    }
                }
            })
        });

        $(this).delegate('.do-zhi','click',function(){
            var code = $("#runscriptCode").val();
            var data = {
                "code":code,
            };
            $.ajax({
                url:'/scriptedit/run',
                type:'post',
                data:data,
                dataType:'json',
                success:function(datas){
                    if(datas.code == 200){
                        $("#test").hide();
                        $("#log_window").hide();
                        $(".my-script").hide();
                    }else{
                        alert("执行失败!");
                    }
                },error:function () {
                    alert("服务器异常");
                }
            })
        });
    })
</script>
</body>
</html>